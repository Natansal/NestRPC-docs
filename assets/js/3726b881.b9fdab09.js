"use strict";(self.webpackChunknestjs_rpc_docs=self.webpackChunknestjs_rpc_docs||[]).push([[794],{5908:(r,e,n)=>{n.r(e),n.d(e,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"client/error-handling","title":"Error Handling","description":"Handling HTTP and network errors in the client. Try/catch patterns, error types, and Axios interceptors.","source":"@site/docs/client/error-handling.md","sourceDirName":"client","slug":"/client/error-handling","permalink":"/NestRPC-docs/docs/client/error-handling","draft":false,"unlisted":false,"editUrl":"https://github.com/Natansal/NestRPC-docs/blob/main/docs/client/error-handling.md","tags":[],"version":"current","frontMatter":{"title":"Error Handling","description":"Handling HTTP and network errors in the client. Try/catch patterns, error types, and Axios interceptors."},"sidebar":"tutorialSidebar","previous":{"title":"File Uploads","permalink":"/NestRPC-docs/docs/client/file-uploads"},"next":{"title":"FAQ","permalink":"/NestRPC-docs/docs/faq"}}');var t=n(4848),o=n(8453);const i={title:"Error Handling",description:"Handling HTTP and network errors in the client. Try/catch patterns, error types, and Axios interceptors."},c="Client Error Handling",a={},l=[{value:"\ud83c\udfaf Basic Error Handling",id:"-basic-error-handling",level:2},{value:"\ud83d\udccb Error Sources",id:"-error-sources",level:2},{value:"\ud83d\udd0d Error Type Checking",id:"-error-type-checking",level:2},{value:"\ud83c\udfa8 React Error Handling",id:"-react-error-handling",level:2},{value:"\ud83d\udd27 Axios Interceptors",id:"-axios-interceptors",level:2},{value:"\ud83c\udfaf Error Helper Functions",id:"-error-helper-functions",level:2},{value:"\ud83d\udd04 Retry Logic",id:"-retry-logic",level:2},{value:"\ud83d\udcda Further Reading",id:"-further-reading",level:2}];function d(r){const e={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...r.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"client-error-handling",children:"Client Error Handling"})}),"\n",(0,t.jsx)(e.p,{children:"When the server returns an error for a call, Axios rejects the promise with an error containing the HTTP status and data. This guide covers how to handle these errors effectively."}),"\n",(0,t.jsx)(e.h2,{id:"-basic-error-handling",children:"\ud83c\udfaf Basic Error Handling"}),"\n",(0,t.jsx)(e.p,{children:"Handle errors with try/catch:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-typescript",children:"import { rpc } from './rpc-client';\nimport { AxiosError } from 'axios';\n\ntry {\n  const { data: user } = await rpc.user.queries.getUser({ id: 'missing' });\n} catch (error) {\n  if (error instanceof AxiosError) {\n    console.error('Status:', error.response?.status);\n    console.error('Data:', error.response?.data);\n    // { statusCode: 404, message: 'User not found' }\n  }\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"-error-sources",children:"\ud83d\udccb Error Sources"}),"\n",(0,t.jsx)(e.p,{children:"Errors can come from different sources:"}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"Source"}),(0,t.jsx)(e.th,{children:"Type"}),(0,t.jsx)(e.th,{children:"Example"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsxs)(e.td,{children:["Nest ",(0,t.jsx)(e.code,{children:"HttpException"})]}),(0,t.jsx)(e.td,{children:(0,t.jsx)(e.code,{children:"AxiosError"})}),(0,t.jsxs)(e.td,{children:[(0,t.jsx)(e.code,{children:"BadRequestException"})," \u2192 400"]})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Network errors"}),(0,t.jsx)(e.td,{children:(0,t.jsx)(e.code,{children:"AxiosError"})}),(0,t.jsx)(e.td,{children:"Connection timeout, DNS failure"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Request cancellation"}),(0,t.jsx)(e.td,{children:(0,t.jsx)(e.code,{children:"AxiosError"})}),(0,t.jsx)(e.td,{children:"Request aborted"})]})]})]}),"\n",(0,t.jsx)(e.h2,{id:"-error-type-checking",children:"\ud83d\udd0d Error Type Checking"}),"\n",(0,t.jsx)(e.p,{children:"Check error types for appropriate handling:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-typescript",children:"import { AxiosError } from 'axios';\n\nasync function getUserSafely(id: string) {\n  try {\n    const { data: user } = await rpc.user.queries.getUser({ id });\n    return { success: true, user };\n  } catch (error) {\n    if (error instanceof AxiosError) {\n      if (error.response) {\n        // Server responded with error\n        const status = error.response.status;\n        const data = error.response.data;\n        \n        switch (status) {\n          case 400:\n            return { success: false, error: data.message || 'Bad request' };\n          case 401:\n            return { success: false, error: 'Unauthorized' };\n          case 403:\n            return { success: false, error: 'Forbidden' };\n          case 404:\n            return { success: false, error: 'Not found' };\n          case 500:\n            return { success: false, error: 'Server error' };\n          default:\n            return { success: false, error: 'Unknown error' };\n        }\n      } else if (error.request) {\n        // Request made but no response\n        return { success: false, error: 'Network error' };\n      }\n    }\n    return { success: false, error: 'Unknown error' };\n  }\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"-react-error-handling",children:"\ud83c\udfa8 React Error Handling"}),"\n",(0,t.jsx)(e.p,{children:"Handle errors in React components:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-typescript",children:"import { useState } from 'react';\nimport { rpc } from './rpc-client';\nimport { AxiosError } from 'axios';\n\nfunction UserProfile({ userId }: { userId: string }) {\n  const [user, setUser] = useState(null);\n  const [error, setError] = useState<string | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    async function loadUser() {\n      try {\n        setLoading(true);\n        setError(null);\n        const { data } = await rpc.user.queries.getUser({ id: userId });\n        setUser(data);\n      } catch (err) {\n        if (err instanceof AxiosError) {\n          if (err.response?.status === 404) {\n            setError('User not found');\n          } else {\n            setError(err.response?.data?.message || 'Failed to load user');\n          }\n        } else {\n          setError('An unexpected error occurred');\n        }\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    loadUser();\n  }, [userId]);\n\n  if (loading) return <div>Loading...</div>;\n  if (error) return <div>Error: {error}</div>;\n  if (!user) return <div>No user found</div>;\n\n  return <div>{user.name}</div>;\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"-axios-interceptors",children:"\ud83d\udd27 Axios Interceptors"}),"\n",(0,t.jsx)(e.p,{children:"Use interceptors for global error handling:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-typescript",children:"import axios, { AxiosError } from 'axios';\nimport { RpcClient } from '@nestjs-rpc/client';\nimport type { Manifest } from '../server/nest-rpc.config';\n\nconst axiosInstance = axios.create();\n\n// Response interceptor for error handling\naxiosInstance.interceptors.response.use(\n  (response) => response,\n  (error: AxiosError) => {\n    if (error.response?.status === 401) {\n      // Handle unauthorized - redirect to login\n      window.location.href = '/login';\n    } else if (error.response?.status === 403) {\n      // Handle forbidden\n      console.error('Access forbidden');\n    } else if (error.response?.status >= 500) {\n      // Handle server errors\n      console.error('Server error:', error.response?.data);\n    }\n    return Promise.reject(error);\n  }\n);\n\nconst client = new RpcClient<Manifest>({\n  baseUrl: 'http://localhost:3000',\n  axiosInstance,\n});\n\nexport const rpc = client.routers();\n"})}),"\n",(0,t.jsx)(e.h2,{id:"-error-helper-functions",children:"\ud83c\udfaf Error Helper Functions"}),"\n",(0,t.jsx)(e.p,{children:"Create reusable error handling utilities:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-typescript",children:"import { AxiosError } from 'axios';\n\nexport function getErrorMessage(error: unknown): string {\n  if (error instanceof AxiosError) {\n    if (error.response) {\n      return error.response.data?.message || 'An error occurred';\n    } else if (error.request) {\n      return 'Network error. Please check your connection.';\n    }\n  }\n  return 'An unexpected error occurred';\n}\n\nexport function getErrorStatus(error: unknown): number | null {\n  if (error instanceof AxiosError && error.response) {\n    return error.response.status;\n  }\n  return null;\n}\n\n// Usage\ntry {\n  await rpc.user.queries.getUser({ id: '1' });\n} catch (error) {\n  const message = getErrorMessage(error);\n  const status = getErrorStatus(error);\n  console.error(`Error ${status}: ${message}`);\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"-retry-logic",children:"\ud83d\udd04 Retry Logic"}),"\n",(0,t.jsx)(e.p,{children:"Implement retry logic for transient errors:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-typescript",children:"async function retryRequest<T>(\n  fn: () => Promise<T>,\n  maxRetries = 3,\n  delay = 1000\n): Promise<T> {\n  for (let i = 0; i < maxRetries; i++) {\n    try {\n      return await fn();\n    } catch (error) {\n      if (i === maxRetries - 1) throw error;\n      \n      // Only retry on network errors or 5xx errors\n      if (error instanceof AxiosError) {\n        const status = error.response?.status;\n        if (status && status >= 500) {\n          await new Promise(resolve => setTimeout(resolve, delay * (i + 1)));\n          continue;\n        }\n      }\n      throw error;\n    }\n  }\n  throw new Error('Max retries exceeded');\n}\n\n// Usage\nconst { data } = await retryRequest(() => \n  rpc.user.queries.getUser({ id: '1' })\n);\n"})}),"\n",(0,t.jsx)(e.h2,{id:"-further-reading",children:"\ud83d\udcda Further Reading"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://axios-http.com/docs/handling_errors",children:"Axios Error Handling"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://axios-http.com/docs/interceptors",children:"Axios Interceptors"})}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"/docs/server/error-handling",children:"Server Error Handling"})," - How errors are thrown on the server"]}),"\n"]})]})}function u(r={}){const{wrapper:e}={...(0,o.R)(),...r.components};return e?(0,t.jsx)(e,{...r,children:(0,t.jsx)(d,{...r})}):d(r)}},8453:(r,e,n)=>{n.d(e,{R:()=>i,x:()=>c});var s=n(6540);const t={},o=s.createContext(t);function i(r){const e=s.useContext(o);return s.useMemo(function(){return"function"==typeof r?r(e):{...e,...r}},[e,r])}function c(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(t):r.components||t:i(r.components),s.createElement(o.Provider,{value:e},r.children)}}}]);