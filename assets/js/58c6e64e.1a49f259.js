"use strict";(self.webpackChunknestjs_rpc_docs=self.webpackChunknestjs_rpc_docs||[]).push([[423],{144:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"query/overview","title":"React Query Integration Overview","description":"Type-safe React Query hooks for NestRPC. Automatic caching, background refetching, and cache invalidation.","source":"@site/docs/query/overview.md","sourceDirName":"query","slug":"/query/overview","permalink":"/NestRPC-docs/docs/query/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/Natansal/NestRPC-docs/blob/main/docs/query/overview.md","tags":[],"version":"current","frontMatter":{"title":"React Query Integration Overview","description":"Type-safe React Query hooks for NestRPC. Automatic caching, background refetching, and cache invalidation."},"sidebar":"tutorialSidebar","previous":{"title":"Error Handling","permalink":"/NestRPC-docs/docs/client/error-handling"},"next":{"title":"Query Hooks","permalink":"/NestRPC-docs/docs/query/queries"}}');var i=t(4848),s=t(8453);const a={title:"React Query Integration Overview",description:"Type-safe React Query hooks for NestRPC. Automatic caching, background refetching, and cache invalidation."},c="React Query Integration Overview",l={},o=[{value:"\ud83c\udfaf Why @nestjs-rpc/query?",id:"-why-nestjs-rpcquery",level:2},{value:"\ud83d\udce6 Installation",id:"-installation",level:2},{value:"\ud83d\ude80 Quick Start",id:"-quick-start",level:2},{value:"1. Setup QueryClientProvider",id:"1-setup-queryclientprovider",level:3},{value:"2. Use RPC Queries",id:"2-use-rpc-queries",level:3},{value:"3. Use RPC Mutations",id:"3-use-rpc-mutations",level:3},{value:"\ud83c\udfa8 Core Concepts",id:"-core-concepts",level:2},{value:"Direct Hooks vs Factory Pattern",id:"direct-hooks-vs-factory-pattern",level:3},{value:"Automatic Cache Invalidation",id:"automatic-cache-invalidation",level:3},{value:"Type Safety",id:"type-safety",level:3},{value:"\ud83d\udcda What&#39;s Next?",id:"-whats-next",level:2},{value:"\ud83c\udd9a Comparison: Raw RPC vs React Query",id:"-comparison-raw-rpc-vs-react-query",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"react-query-integration-overview",children:"React Query Integration Overview"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@nestjs-rpc/query"})," package provides type-safe React Query hooks that seamlessly integrate your RPC endpoints with TanStack Query. Get powerful caching, synchronization, and state management with zero boilerplate."]}),"\n",(0,i.jsx)(n.h2,{id:"-why-nestjs-rpcquery",children:"\ud83c\udfaf Why @nestjs-rpc/query?"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Stop managing API state manually."})," This package gives you:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\ud83d\udd12 ",(0,i.jsx)(n.strong,{children:"End-to-End Type Safety"})," - Full TypeScript inference from RPC methods to React hooks"]}),"\n",(0,i.jsxs)(n.li,{children:["\u26a1 ",(0,i.jsx)(n.strong,{children:"Automatic Caching"})," - Built on TanStack Query with intelligent cache management"]}),"\n",(0,i.jsxs)(n.li,{children:["\ud83d\udd04 ",(0,i.jsx)(n.strong,{children:"Auto Invalidation"})," - Automatically invalidate related queries after mutations"]}),"\n",(0,i.jsxs)(n.li,{children:["\ud83c\udfaf ",(0,i.jsx)(n.strong,{children:"Zero Boilerplate"})," - No manual query key management or cache invalidation logic"]}),"\n",(0,i.jsxs)(n.li,{children:["\ud83e\udde9 ",(0,i.jsx)(n.strong,{children:"Factory Pattern"})," - Create reusable hooks with default options"]}),"\n",(0,i.jsxs)(n.li,{children:["\ud83d\udce4 ",(0,i.jsx)(n.strong,{children:"File Upload Support"})," - Works seamlessly with RPC file uploads"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-installation",children:"\ud83d\udce6 Installation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install @nestjs-rpc/query @nestjs-rpc/client @tanstack/react-query react\n# or\npnpm add @nestjs-rpc/query @nestjs-rpc/client @tanstack/react-query react\n# or\nyarn add @nestjs-rpc/query @nestjs-rpc/client @tanstack/react-query react\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Peer Dependencies:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"@nestjs-rpc/client"})," - The RPC client library"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"react"})," - React 18.0.0 or higher"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"@tanstack/react-query"})," - React Query 5.0.0 or higher"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-quick-start",children:"\ud83d\ude80 Quick Start"}),"\n",(0,i.jsx)(n.h3,{id:"1-setup-queryclientprovider",children:"1. Setup QueryClientProvider"}),"\n",(0,i.jsxs)(n.p,{children:["Wrap your app with ",(0,i.jsx)(n.code,{children:"QueryClientProvider"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// App.tsx\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\nimport { RpcClient } from '@nestjs-rpc/client';\nimport type { Manifest } from './path-to-your-manifest';\n\n// Create your RPC client\nconst rpcClient = new RpcClient<Manifest>({\n  baseUrl: 'http://localhost:3000',\n});\nexport const rpc = rpcClient.routers();\n\n// Create React Query client\nconst queryClient = new QueryClient();\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      {/* Your app components */}\n    </QueryClientProvider>\n  );\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"2-use-rpc-queries",children:"2. Use RPC Queries"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { useRpcQuery } from '@nestjs-rpc/query';\nimport { rpc } from './rpc-client';\n\nfunction UserList() {\n  const { data, isLoading, error } = useRpcQuery(\n    rpc.user.queries.listUsers,\n    undefined, // body (optional for methods with no body)\n  );\n\n  if (isLoading) return <div>Loading...</div>;\n  if (error) return <div>Error: {error.message}</div>;\n\n  return (\n    <ul>\n      {data?.map((user) => (\n        <li key={user.id}>{user.name}</li>\n      ))}\n    </ul>\n  );\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"3-use-rpc-mutations",children:"3. Use RPC Mutations"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { useRpcMutation } from '@nestjs-rpc/query';\nimport { rpc } from './rpc-client';\n\nfunction CreateUser() {\n  const mutation = useRpcMutation(rpc.user.mutations.createUser, {\n    invalidate: [rpc.user.queries.listUsers], // Auto-invalidate after success\n    onSuccess: (data) => {\n      console.log('User created:', data);\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    mutation.mutate({\n      body: {\n        name: 'John Doe',\n        email: 'john@example.com',\n      },\n    });\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <button type=\"submit\" disabled={mutation.isPending}>\n        {mutation.isPending ? 'Creating...' : 'Create User'}\n      </button>\n    </form>\n  );\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"That's it!"})," You get:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u2705 Full TypeScript autocomplete"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Automatic query key generation"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Intelligent caching"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Automatic cache invalidation"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-core-concepts",children:"\ud83c\udfa8 Core Concepts"}),"\n",(0,i.jsx)(n.h3,{id:"direct-hooks-vs-factory-pattern",children:"Direct Hooks vs Factory Pattern"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Direct Hooks"})," (",(0,i.jsx)(n.code,{children:"useRpcQuery"}),", ",(0,i.jsx)(n.code,{children:"useRpcMutation"}),"):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use for one-off queries/mutations"}),"\n",(0,i.jsx)(n.li,{children:"No default options"}),"\n",(0,i.jsx)(n.li,{children:"Simple and straightforward"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Factory Pattern"})," (",(0,i.jsx)(n.code,{children:"createRpcQuery"}),", ",(0,i.jsx)(n.code,{children:"createRpcMutation"}),"):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Create reusable hooks with default options"}),"\n",(0,i.jsx)(n.li,{children:"Perfect for domain-specific hooks"}),"\n",(0,i.jsx)(n.li,{children:"Override options per usage"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Direct hook - one-off usage\nconst { data } = useRpcQuery(rpc.user.getUserById, { id: '123' });\n\n// Factory pattern - reusable hook\nconst useUserById = createRpcQuery(rpc.user.getUserById, {\n  staleTime: 60000,\n});\n\n// Use the reusable hook\nconst { data } = useUserById({ id: '123' });\n"})}),"\n",(0,i.jsx)(n.h3,{id:"automatic-cache-invalidation",children:"Automatic Cache Invalidation"}),"\n",(0,i.jsx)(n.p,{children:"Mutations can automatically invalidate related queries:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const useCreateUser = createRpcMutation(rpc.user.mutations.createUser, {\n  invalidate: [\n    rpc.user.queries.listUsers, // Invalidate list\n    rpc.user.queries.getUserById, // Invalidate detail queries\n  ],\n});\n\n// After successful mutation, all queries for these routes are invalidated\n"})}),"\n",(0,i.jsx)(n.h3,{id:"type-safety",children:"Type Safety"}),"\n",(0,i.jsx)(n.p,{children:"The hooks automatically infer types from your RPC manifest:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Server method signature:\n@Route()\nasync getUserById(id: string): Promise<User> {\n  return { id, name: 'John', email: 'john@example.com' };\n}\n\n// Client automatically gets:\nconst { data } = useRpcQuery(rpc.user.getUserById, { id: '123' });\n//    ^? { data: User }\n//    ^? body parameter is typed as { id: string }\n//    ^? Full autocomplete for User properties\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"If your server types change, your client code will show TypeScript errors immediately!"})}),"\n",(0,i.jsx)(n.h2,{id:"-whats-next",children:"\ud83d\udcda What's Next?"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Learn about ",(0,i.jsx)(n.a,{href:"/docs/query/queries",children:"Query Hooks"})," in detail"]}),"\n",(0,i.jsxs)(n.li,{children:["Explore ",(0,i.jsx)(n.a,{href:"/docs/query/mutations",children:"Mutation Hooks"})," with automatic invalidation"]}),"\n",(0,i.jsxs)(n.li,{children:["Discover ",(0,i.jsx)(n.a,{href:"/docs/query/advanced",children:"Advanced Features"})," like additional query keys and file uploads"]}),"\n",(0,i.jsxs)(n.li,{children:["See the ",(0,i.jsx)(n.a,{href:"https://github.com/Natansal/NestRPC/tree/main/example",children:"complete example"})," with React Query integration"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-comparison-raw-rpc-vs-react-query",children:"\ud83c\udd9a Comparison: Raw RPC vs React Query"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Feature"}),(0,i.jsx)(n.th,{children:"Raw RPC"}),(0,i.jsx)(n.th,{children:"React Query"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Type Safety"}),(0,i.jsx)(n.td,{children:"\u2705 Full"}),(0,i.jsx)(n.td,{children:"\u2705 Full"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Caching"}),(0,i.jsx)(n.td,{children:"\u274c Manual"}),(0,i.jsx)(n.td,{children:"\u2705 Automatic"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Background Refetching"}),(0,i.jsx)(n.td,{children:"\u274c No"}),(0,i.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Cache Invalidation"}),(0,i.jsx)(n.td,{children:"\u274c Manual"}),(0,i.jsx)(n.td,{children:"\u2705 Automatic"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Loading States"}),(0,i.jsx)(n.td,{children:"\u274c Manual"}),(0,i.jsx)(n.td,{children:"\u2705 Built-in"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Error States"}),(0,i.jsx)(n.td,{children:"\u274c Manual"}),(0,i.jsx)(n.td,{children:"\u2705 Built-in"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Optimistic Updates"}),(0,i.jsx)(n.td,{children:"\u274c Manual"}),(0,i.jsx)(n.td,{children:"\u2705 Supported"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"For React applications, React Query integration is highly recommended!"})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>c});var r=t(6540);const i={},s=r.createContext(i);function a(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);