"use strict";(self.webpackChunknestjs_rpc_docs=self.webpackChunknestjs_rpc_docs||[]).push([[864],{2975:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>d,frontMatter:()=>c,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"best-practices","title":"Best Practices","description":"Recommended patterns for server and client usage","source":"@site/docs/best-practices.md","sourceDirName":".","slug":"/best-practices","permalink":"/NestRPC-docs/docs/best-practices","draft":false,"unlisted":false,"editUrl":"https://github.com/Natansal/NestRPC-docs/blob/main/docs/best-practices.md","tags":[],"version":"current","frontMatter":{"title":"Best Practices","description":"Recommended patterns for server and client usage"},"sidebar":"tutorialSidebar","previous":{"title":"Quick Start","permalink":"/NestRPC-docs/docs/quick-start"},"next":{"title":"Server Overview","permalink":"/NestRPC-docs/docs/server/overview"}}');var r=s(4848),i=s(8453);const c={title:"Best Practices",description:"Recommended patterns for server and client usage"},o=void 0,a={},l=[{value:"Server",id:"server",level:3},{value:"Client",id:"client",level:3},{value:"Project structure",id:"project-structure",level:3}];function p(e){const n={a:"a",code:"code",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h3,{id:"server",children:"Server"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Export a manifest and its type"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// nest-rpc.config.ts\nimport { defineManifest } from '@nestjs-rpc/server';\n\nexport const manifest = defineManifest({\n  // ...routers\n});\n\nexport type Manifest = typeof manifest;\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Initialize before app creation"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { NestFactory } from '@nestjs/core';\nimport { AppModule } from './app.module';\nimport { nestRpcInit } from '@nestjs-rpc/server';\nimport { manifest } from './nest-rpc.config';\n\nasync function bootstrap() {\n  nestRpcInit(manifest, { apiPrefix: 'nestjs-rpc' });\n  const app = await NestFactory.create(AppModule);\n  await app.listen(3000);\n}\nbootstrap();\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Keep your routers thin","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Inject services for business logic"}),"\n",(0,r.jsx)(n.li,{children:"Validate inputs with pipes or class-validator"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"client",children:"Client"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Create a single client instance"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { RpcClient } from '@nestjs-rpc/client';\nimport type { Manifest } from '../server/nest-rpc.config';\n\nexport const client = new RpcClient<Manifest>({\n  baseUrl: import.meta.env.VITE_API_URL ?? 'http://localhost:3000',\n  apiPrefix: 'nestjs-rpc',\n});\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Prefer ",(0,r.jsx)(n.code,{children:"routers()"})," and router constants"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export const rpc = client.routers();\nexport const userRepo = rpc.user;\n\n// Usage\nconst { data: user } = await rpc.user.queries.getUser({ id: '1' });\nconst { data: one } = await userRepo.queries.getUser({ id: '1' });\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use per-call overrides sparingly"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"await userRepo.queries.getUser({ id: '1' }, {\n  requestOptions: { headers: { Authorization: 'Bearer \u2026' } },\n});\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Handle errors with Axios patterns"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"try {\n  await userRepo.queries.getUser({ id: 'missing' });\n} catch (e) {\n  console.error(e.response?.status, e.response?.data);\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Further reading:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Axios docs: ",(0,r.jsx)(n.a,{href:"https://axios-http.com",children:"https://axios-http.com"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"project-structure",children:"Project structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"src/\n  app.module.ts\n  main.ts\n  nest-rpc.config.ts   # manifest + Manifest type\n  routers/\n    user.queries.router.ts\n    user.mutations.router.ts\n  client/\n    rpc.ts             # RpcClient + routers() + router constants\n"})})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>o});var t=s(6540);const r={},i=t.createContext(r);function c(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);